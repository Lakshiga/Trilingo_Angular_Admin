.activity-editor-page {
  min-height: 100vh;
  padding: 24px;
  display: flex;
  flex-direction: column;
  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #f0f9ff 100%);
}

/* Header */
.header .actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 16px;
}
.actions .back-button {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
  border-radius: 999px;
  padding: 10px 20px;
  background-color: white;
  border: 1px solid #e2e8f0;
}
.actions .back-button mat-icon { font-size: 20px; }
.actions-spacer { flex: 1; }

.content {
  margin-top: 20px;
  display: flex;
  flex-direction: column;
  min-height: 0;
  flex: 1;
}

.top-form-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  padding: 24px;
  margin-bottom: 24px;
  
  background: rgba(255, 255, 255, 0.7);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  
  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, 0.3);
  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
}

.form-item { display: flex; flex-direction: column; }
.form-item label {
  font-size: 0.875rem;
  font-weight: 600;
  color: #334155;
  margin-bottom: 8px;
}
.form-item .form-input {
  width: 100%;
  border: 1px solid #cbd5e1;
  border-radius: 8px;
  padding: 12px 14px;
  font-size: 0.95rem;
  font-weight: 500;
  background: #ffffff;
  color: #0f172a;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}
.form-item .form-input:focus {
  outline: none;
  border-color: #346e8c;
  box-shadow: 0 0 0 3px rgba(52, 110, 140, 0.2);
}
.form-item .form-input::placeholder { color: #94a3b8; font-weight: 400; }
.select-shell { position: relative; }
.select-shell mat-icon {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
  color: #64748b;
}
.select-shell select { appearance: none; cursor: pointer; }
.select-shell.disabled select { cursor: not-allowed; opacity: 0.65; }
.hint-text { font-size: 0.75rem; color: #f97316; margin-top: 4px; font-weight: 500; }

/* Main grid layout */
.activity-grid {
  display: grid;
  grid-template-columns: 1fr 1.2fr 1fr;
  gap: 24px;
  align-items: stretch;
  grid-auto-rows: minmax(0, 1fr);
  flex: 1;
  min-height: 0;
}

.column { display: flex; flex-direction: column; gap: 20px; min-height: 0; }

.panel {
  display: flex;
  flex-direction: column;
  height: 100%;
  min-height: 0;
  overflow: hidden;

  background: rgba(255, 255, 255, 0.6);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);

  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, 0.4);
  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.08);

  border-top: 4px solid #346e8c; 
  padding: 24px;
}

.template-panel { border-top-color: #0ea5e9; }
.exercises-panel { border-top-color: #4f46e5; } 
.preview-panel { border-top-color: #10b981; } 
.panel-header {
  display: flex;
  align-items: center; 
  gap: 12px;
  margin-bottom: 12px;
}

.panel-header::before {
  content: '';
  display: inline-block;
  width: 24px;
  height: 24px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  flex-shrink: 0; 
}
.template-panel .panel-header::before { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%230ea5e9"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/></svg>'); }
.exercises-panel .panel-header::before { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%234f46e5"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>'); }
.preview-panel .panel-header::before { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2310b981"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5C21.27 7.61 17 4.5 12 4.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>'); }


.panel-header h3 { margin: 0; font-size: 1.1rem; font-weight: 600; color: #0f172a; }
.panel-subtitle { margin: 0 0 12px; color: #475569; font-size: 0.9rem; }

/* JSON Template */
.template-content {
  background: #ffffff;
  color: #1f2937;
  border-radius: 12px;
  padding: 16px;
  flex: 1;
  overflow: auto;
  font-family: "JetBrains Mono", "Fira Code", monospace;
  font-size: 0.9rem;
  border: 1px solid #e2e8f0;
}
.template-content pre { margin: 0; white-space: pre-wrap; word-break: break-word; }

.no-template {
  padding: 24px;
  border: 2px dashed #94a3b8;
  border-radius: 12px;
  text-align: center;
  color: #475569;
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
}

.no-template::before {
  content: '';
  display: block;
  width: 64px;
  height: 64px;
  margin-bottom: 16px;
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="%2394a3b8" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5" /></svg>');
  opacity: 0.5;
}

/* Exercises */
.exercise-editor-wrapper {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  margin-bottom: 16px;
  padding-right: 8px; /* For scrollbar */
}
.add-exercise-btn {
  width: 100%;
  padding: 10px 16px;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  border-radius: 999px;
}
.badge {
  background: #eef2ff;
  color: #4338ca; 
  padding: 6px 12px;
  border-radius: 999px;
  font-weight: 600;
  font-size: 0.9rem;
}

/* Preview */
.preview-wrapper {
  flex: 1;
  display: flex;
  min-height: 0;
  height: 100%;
}
.preview-wrapper app-device-preview { flex: 1; width: 100%; }

/* Responsive */
@media (max-width: 1280px) {
  .activity-grid { grid-template-columns: 1fr; }
}
@media (max-width: 900px) {
  .top-form-grid { grid-template-columns: 1fr; }
}