<ng-container *ngIf="isLoginPage || !(isAuthenticated$ | async); else adminLayout">
  <router-outlet />
</ng-container>

<ng-template #adminLayout>
  <div class="admin-layout flex flex-col h-screen w-full bg-slate-50 dark:bg-slate-900 transition-colors duration-300 overflow-hidden">
    
    <!-- Top Navigation Bar -->
    <header class="sticky top-0 w-full bg-[#346e8c] border-b border-white/10 shadow-sm z-[1000]">
      <div class="flex justify-between items-center h-[72px] px-8 max-w-full relative lg:px-5">
        
        <div class="flex items-center h-full">
          <div class="w-14 h-14 rounded-full bg-white shadow-md border border-gray-200 flex items-center justify-center overflow-hidden transition-all hover:shadow-lg hover:-translate-y-0.5">
            <img src="/assets/images/logo.png" alt="Q-bit Logo" class="w-full h-full object-cover rounded-full">
          </div>
        </div>
    


        
        
        <!-- Center: Desktop Navigation -->
        <nav class="absolute left-1/2 -translate-x-1/2 hidden lg:flex items-center gap-5 h-full z-[5]">

          <a routerLink="/dashboard" routerLinkActive="active" #dashboardLink="routerLinkActive"
             [ngClass]="{'active': dashboardLink.isActive}"
             class="nav-link flex items-center gap-2 px-4.5 py-2.5 text-white font-medium text-sm whitespace-nowrap">
            <span>Dashboard</span>
          </a>
        
          <a routerLink="/main-activities" routerLinkActive="active" #mainActivitiesLink="routerLinkActive"
             [ngClass]="{'active': mainActivitiesLink.isActive}"
             class="nav-link flex items-center gap-2 px-4.5 py-2.5 text-white font-medium text-sm whitespace-nowrap">
            <span>Main Activities</span>
          </a>
        
          <a routerLink="/activity-types" routerLinkActive="active" #activityTypesLink="routerLinkActive"
             [ngClass]="{'active': activityTypesLink.isActive}"
             class="nav-link flex items-center gap-2 px-4.5 py-2.5 text-white font-medium text-sm whitespace-nowrap">
            <span>Activity Types</span>
          </a>
        
          <a routerLink="/levels" routerLinkActive="active" #levelsLink="routerLinkActive"
             [ngClass]="{'active': levelsLink.isActive}"
             class="nav-link flex items-center gap-2 px-4.5 py-2.5 text-white font-medium text-sm whitespace-nowrap">
            <span>Levels</span>
          </a>
        
        </nav>
        
        
        <!-- Right: Profile Dropdown -->
        <div class="flex items-center justify-end flex-shrink-0 z-10">
          <div class="relative">
            <div class="flex items-center gap-3 px-3 py-1.5 rounded-xl cursor-pointer transition-all bg-white/10 hover:bg-white/20" (click)="navigateToProfile()">
              <div class="relative flex items-center justify-center">
                <img [src]="getProfileImageUrl()" [alt]="userProfile?.username || 'User'" class="w-9 h-9 rounded-lg object-cover border-2 border-white shadow-sm" onerror="this.src='/assets/images/default-profile.svg'">
                <span class="absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 border-2 border-white rounded-full shadow-sm"></span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile Navigation -->
      <nav class="flex items-center gap-1.5 px-4 py-3 overflow-x-auto scrollbar-hide border-t border-white/10 bg-[#346E8C] lg:hidden">
        <a routerLink="/dashboard" routerLinkActive="active" #dashboardLinkMobile="routerLinkActive" [ngClass]="{'active': dashboardLinkMobile.isActive}" class="flex-shrink-0 px-4 py-2 text-white no-underline text-xs font-medium rounded-lg transition-all whitespace-nowrap relative hover:bg-white/20">
          <span>Dashboard</span>
        </a>
        <a routerLink="/main-activities" routerLinkActive="active" #mainActivitiesLinkMobile="routerLinkActive" [ngClass]="{'active': mainActivitiesLinkMobile.isActive}" class="flex-shrink-0 px-4 py-2 text-white no-underline text-xs font-medium rounded-lg transition-all whitespace-nowrap relative hover:bg-white/20">
          <span>Main Activities</span>
        </a>
        <a routerLink="/activity-types" routerLinkActive="active" #activityTypesLinkMobile="routerLinkActive" [ngClass]="{'active': activityTypesLinkMobile.isActive}" class="flex-shrink-0 px-4 py-2 text-white no-underline text-xs font-medium rounded-lg transition-all whitespace-nowrap relative hover:bg-white/20">
          <span>Activity Types</span>
        </a>
        <a routerLink="/levels" routerLinkActive="active" #levelsLinkMobile="routerLinkActive" [ngClass]="{'active': levelsLinkMobile.isActive}" class="flex-shrink-0 px-4 py-2 text-white no-underline text-xs font-medium rounded-lg transition-all whitespace-nowrap relative hover:bg-white/20">
          <span>Levels</span>
        </a>
      </nav>
    </header>

    <!-- Main Content -->
    <div class="content-wrapper flex flex-1 w-full overflow-hidden">
      <main class="main-content flex-1 w-full p-4 sm:p-6 overflow-y-auto scrollbar-hide bg-white">
          <router-outlet />
      </main>
    </div>
  </div>
</ng-template>