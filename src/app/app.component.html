<ng-container *ngIf="isLoginPage || !(isAuthenticated$ | async); else adminLayout">
  <router-outlet />
</ng-container>

<ng-template #adminLayout>
  <div class="admin-layout flex flex-col min-h-screen bg-slate-50 dark:bg-slate-900 transition-colors duration-300">
    
    <!-- Top Navigation Bar -->
    <header class="top-navbar">
      <div class="navbar-content">
        
        <!-- Left: Logo and Brand -->
        <div class="navbar-left">
          <div class="brand-container">
            <div class="brand-logo-wrapper">
              <img src="/assets/images/logo.png" alt="Trilingo Admin Logo" class="brand-logo">
            </div>
            <h1 class="brand-name">Trilingo</h1>
          </div>
        </div>
        
        <!-- Center: Desktop Navigation -->
        <nav class="navbar-center">
          <a routerLink="/dashboard" routerLinkActive="active" #dashboardLink="routerLinkActive" [ngClass]="{'active': dashboardLink.isActive}" class="nav-link">
            <span class="nav-icon-wrapper">
              <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" viewBox="0 0 20 20" fill="currentColor">
                <path d="M2 10a8 8 0 018-8v8h8a8 8 0 11-16 0z" /><path d="M12 2.252A8.014 8.014 0 0117.748 8H12V2.252z" />
              </svg>
            </span>
            <span class="nav-text">Dashboard</span>
          </a>
          <a routerLink="/main-activities" routerLinkActive="active" #mainActivitiesLink="routerLinkActive" [ngClass]="{'active': mainActivitiesLink.isActive}" class="nav-link">
            <span class="nav-icon-wrapper">
              <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" viewBox="0 0 20 20" fill="currentColor">
                <path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
              </svg>
            </span>
            <span class="nav-text">Main Activities</span>
          </a>
          <a routerLink="/activity-types" routerLinkActive="active" #activityTypesLink="routerLinkActive" [ngClass]="{'active': activityTypesLink.isActive}" class="nav-link">
            <span class="nav-icon-wrapper">
              <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" viewBox="0 0 20 20" fill="currentColor">
                <path d="M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" />
              </svg>
            </span>
            <span class="nav-text">Activity Types</span>
          </a>
          <a routerLink="/levels" routerLinkActive="active" #levelsLink="routerLinkActive" [ngClass]="{'active': levelsLink.isActive}" class="nav-link">
            <span class="nav-icon-wrapper">
              <svg xmlns="http://www.w3.org/2000/svg" class="nav-icon" viewBox="0 0 20 20" fill="currentColor">
                <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3.5a1 1 0 000 1.74l7 3.5c.267.133.585.133.852 0l7-3.5a1 1 0 000-1.74l-7-3.5zM10 9.42L3.05 6 10 2.58 16.95 6 10 9.42z" />
                <path d="M10 11.42l-7-3.5a1 1 0 00-.788 1.74l7 3.5c.267.133.585.133.852 0l7-3.5a1 1 0 00-.788-1.74l-7 3.5z" />
                <path d="M10 13.42l-7-3.5a1 1 0 00-.788 1.74l7 3.5c.267.133.585.133.852 0l7-3.5a1 1 0 00-.788-1.74l-7 3.5z" />
              </svg>
            </span>
            <span class="nav-text">Levels</span>
          </a>
        </nav>
        
        <!-- Right: Profile Dropdown -->
        <div class="navbar-right">
          <div class="profile-dropdown">
            <div class="profile-trigger" (click)="toggleProfileDropdown()">
              <div class="profile-avatar-wrapper">
                <img src="https://i.pravatar.cc/40?u=sarah" alt="User Avatar" class="profile-avatar">
                <span class="profile-status"></span>
              </div>
              <div class="profile-info">
                <span class="profile-name">Admin</span>
                <span class="profile-role">Administrator</span>
              </div>
              <svg xmlns="http://www.w3.org/2000/svg" class="profile-chevron" [class.rotated]="showProfileDropdown" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </div>
            
            <div class="dropdown-menu" 
                 [class.visible]="showProfileDropdown">
              
              <div class="dropdown-header">
                <div class="dropdown-avatar-large">
                  <img src="https://i.pravatar.cc/40?u=sarah" alt="User Avatar" class="profile-avatar-large">
                </div>
                <div class="dropdown-user-info">
                  <p class="dropdown-name">Administrator/p>
                </div>
              </div>

              <div class="dropdown-divider"></div>

              <div class="dropdown-items">
                <a href="#" class="dropdown-item">
                  <svg xmlns="http://www.w3.org/2000/svg" class="dropdown-icon" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
                  </svg>
                  <span>My Profile</span>
                  <svg xmlns="http://www.w3.org/2000/svg" class="dropdown-arrow" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                  </svg>
                </a>
                <a href="#" class="dropdown-item">
                  <svg xmlns="http://www.w3.org/2000/svg" class="dropdown-icon" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.532 1.532 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.532 1.532 0 01-.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
                  </svg>
                  <span>Settings</span>
                  <svg xmlns="http://www.w3.org/2000/svg" class="dropdown-arrow" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                  </svg>
                </a>
              </div>

              <div class="dropdown-divider"></div>

              <a href="#" class="dropdown-item logout-item" (click)="logout(); $event.preventDefault();">
                <svg xmlns="http://www.w3.org/2000/svg" class="dropdown-icon logout-icon" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd" />
                </svg>
                <span>Logout</span>
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Mobile Navigation -->
      <nav class="navbar-center-mobile">
        <a routerLink="/dashboard" routerLinkActive="active" #dashboardLinkMobile="routerLinkActive" [ngClass]="{'active': dashboardLinkMobile.isActive}" class="nav-link-mobile">
          <span>Dashboard</span>
        </a>
        <a routerLink="/main-activities" routerLinkActive="active" #mainActivitiesLinkMobile="routerLinkActive" [ngClass]="{'active': mainActivitiesLinkMobile.isActive}" class="nav-link-mobile">
          <span>Main Activities</span>
        </a>
        <a routerLink="/activity-types" routerLinkActive="active" #activityTypesLinkMobile="routerLinkActive" [ngClass]="{'active': activityTypesLinkMobile.isActive}" class="nav-link-mobile">
          <span>Activity Types</span>
        </a>
        <a routerLink="/levels" routerLinkActive="active" #levelsLinkMobile="routerLinkActive" [ngClass]="{'active': levelsLinkMobile.isActive}" class="nav-link-mobile">
          <span>Levels</span>
        </a>
      </nav>
    </header>

    <!-- Main Content -->
    <div class="content-wrapper flex flex-1 w-full">
      <main class="main-content flex-1 p-4 sm:p-6">
          <router-outlet />
      </main>
    </div>
  </div>
</ng-template>