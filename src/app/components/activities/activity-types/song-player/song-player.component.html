<div class="p-4 sm:p-8 min-h-screen bg-gray-100 flex flex-col items-center w-full">

    @if (currentSongData()) {
    <div class="max-w-3xl w-full bg-white shadow-2xl rounded-2xl overflow-hidden">
    
      <!-- Activity Header -->
      <header class="text-center p-6 bg-indigo-50 border-b border-indigo-200">
        <h1 class="text-2xl font-bold text-indigo-700">{{ text(content.title) }}</h1>
        <p class="text-sm text-gray-600 mt-1 italic">{{ text(content.instruction) }}</p>
      </header>
    
      <!-- Main Player Area -->
      <main class="p-6">
        
        <!-- Album Art and Song Info -->
        <div class="flex items-center mb-6 space-x-6">
          <img 
            [src]="currentSongData().albumArtUrl" 
            alt="Album Art" 
            class="w-24 h-24 object-cover rounded-lg shadow-lg"
            onerror="this.onerror=null; this.src='https://placehold.co/96x96/D1D5DB/4B5563?text=Album';"
          >
          <div>
            <h2 class="text-xl font-bold text-gray-900">{{ text(currentSongData().title) }}</h2>
            <p class="text-sm text-gray-500">{{ currentSongData().artist }}</p>
          </div>
        </div>
    
        <!-- 1. Audio Element (Hidden) -->
        <audio #audioPlayer [src]="currentAudioUrl" style="display: none;"></audio>
    
        <!-- 2. Controls -->
        <div class="flex items-center justify-between space-x-4 mb-4">
          <span class="text-sm font-mono text-gray-600">{{ formatTime(currentTime()) }}</span>
          
          <input 
            type="range" 
            min="0" 
            [max]="duration()" 
            [value]="currentTime()" 
            (input)="seek($event)"
            class="w-full h-2 bg-indigo-200 rounded-lg appearance-none cursor-pointer range-lg"
          >
          
          <span class="text-sm font-mono text-gray-600">{{ formatTime(duration()) }}</span>
        </div>
    
        <div class="flex justify-center mb-6">
          <button mat-fab color="primary" (click)="togglePlay()" aria-label="Play/Pause">
            <mat-icon>{{ isPlaying() ? 'pause' : 'play_arrow' }}</mat-icon>
          </button>
        </div>
    
        <mat-divider></mat-divider>
    
        <!-- 3. Lyrics Area -->
        <div class="lyrics-container h-64 overflow-y-auto mt-6 p-2 space-y-3">
          @for (lyric of currentSongData().lyrics; track $index) {
            <p 
              [id]="'lyric-' + $index"
              class="text-lg text-gray-700 transition-all duration-300 transform cursor-pointer p-1 rounded"
              [ngClass]="{
                'font-extrabold text-indigo-700 bg-yellow-100 scale-[1.02] shadow-sm': currentLyricIndex() === $index,
                'hover:bg-gray-50': currentLyricIndex() !== $index
              }"
              (click)="audioPlayerRef.nativeElement.currentTime = lyric.timestamp"
            >
              {{ text(lyric.content) }}
            </p>
          }
        </div>
      </main>
    </div>
    
    
    } @else {
    <p class="text-xl text-gray-500 p-8">தரவு ஏற்றப்படவில்லை அல்லது பாடல் தரவு காணவில்லை.</p>
    }
    
    </div>