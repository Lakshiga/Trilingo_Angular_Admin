<div class="modal-container" *ngIf="isOpen">
  <div class="device-toggle">
    <mat-button-toggle-group 
      [value]="device" 
      (change)="onDeviceChange($event)"
      class="device-toggle-group">
      <mat-button-toggle value="phone">
        <mat-icon>phone_iphone</mat-icon>
      </mat-button-toggle>
      <mat-button-toggle value="tablet">
        <mat-icon>tablet_mac</mat-icon>
      </mat-button-toggle>
    </mat-button-toggle-group>
  </div>

  <div class="device-frame" [ngClass]="device" [style]="getDeviceStyles()">
    <button 
      mat-icon-button 
      class="close-button" 
      (click)="onClose()"
      aria-label="Close">
      <mat-icon>close</mat-icon>
    </button>

    <div class="header">
      <h3>{{ activity?.title?.en }}</h3>
    </div>

    <div class="exercise-info" *ngIf="isActivityPaginated">
      <span>Exercise {{ currentExerciseIndex + 1 }} of {{ exercises.length }}</span>
    </div>

    <div class="content-area">
      <mat-spinner *ngIf="isLoading"></mat-spinner>
      <app-activity-renderer 
        *ngIf="!isLoading && activity" 
        [activityTypeId]="activity.activityTypeId"
        [content]="currentExerciseData">
      </app-activity-renderer>
      <p *ngIf="!isLoading && !activity" class="error-message">
        Could not load activity.
      </p>
    </div>

    <div class="navigation" *ngIf="isActivityPaginated">
      <button 
        mat-button 
        (click)="goToPrevExercise()" 
        [disabled]="currentExerciseIndex === 0">
        <mat-icon>arrow_back_ios</mat-icon>
        Prev Exercise
      </button>
      <button 
        mat-button 
        (click)="goToNextExercise()" 
        [disabled]="currentExerciseIndex >= exercises.length - 1">
        Next Exercise
        <mat-icon>arrow_forward_ios</mat-icon>
      </button>
    </div>
  </div>
</div>